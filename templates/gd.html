<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Group Discussion Simulation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            font-family: Arial, sans-serif;
            color: #f0f0f0;
            height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .topbar {
            background: rgba(0, 0, 0, 0.8);
            padding: 10px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        .logo {
            font-size: 1.2rem;
            font-weight: bold;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .tagline {
            font-size: 1.2rem;
            color: #ccc;
        }
        .chat-container {
            width: 90%;
            margin-top: 60px;
            height: 85vh;
            background: rgba(36, 36, 62, 0.8);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(0, 123, 255, 0.6);
            display: flex;
            flex-direction: column;
        }
        .chat-title {
            font-size: 1.8rem;
            font-weight: bold;
            text-align: center;
            color: rgba(0,123,255,0.8);
            margin-bottom: 10px;
        }
        .chat-box {
            flex-grow: 1;
            overflow-y: auto;
            border: 1px solid rgba(0, 123, 255, 0.3);
            border-radius: 10px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
        }
        .response-box {
            display: flex;
            gap: 10px;
        }
        .response-box input {
            flex-grow: 1;
            border-radius: 20px;
            padding: 10px 15px;
            border: 1px solid rgba(255, 255, 255, 0.6);
            color: #f0f0f0;
            background: rgba(15, 15, 40, 0.7);
        }
        .response-box button {
            border-radius: 20px;
            padding: 10px 20px;
            background: linear-gradient(135deg, rgba(0,123,255,0.8), rgba(255,99,71,0.8));
            color: #fff;
            border: none;
        }
    </style>
</head>
<body>
    <div class="topbar">
        <div class="logo">
            <img src="/static/logo.png" alt="logo" width="50" height="50">
            SkillSphere
        </div>
        <div class="tagline">Your Gateway to Success</div>
    </div>
    <div class="container chat-container"> 
        <div class="chat-title">Group Discussion Simulation</div>
        <div id="topic-display" class="chat-title"></div>
        <div id="chat-box" class="chat-box"></div>
        <div class="response-box">
            <input type="text" id="user-input" placeholder="Type your response here..." />
            <button id="submit-response">Send</button>
        </div>
    </div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/typewriter-effect@2.18.0/dist/core.js"></script>
<script>
    const topics = [
        "The impact of social media on society",
        "Climate change and its effects",
        "The future of artificial intelligence",
        "The importance of mental health awareness",
        "The role of technology in education" ,
        "The benefits and drawbacks of remote work",
        "The influence of pop culture on youth",
        "The ethics of genetic engineering",
        "The future of space exploration",
        "The importance of cybersecurity in the digital age",
        "Is online education as good as classroom education?",
        "Can art and music bridge cultures?",
        "Should animal testing in research be banned?",
        "Should history books focus more on global views rather than national stories?"
    ];

    // Choose a random topic
    const chosenTopic = topics[Math.floor(Math.random() * topics.length)];
    document.getElementById("topic-display").innerText = `Topic: ${chosenTopic}`;

    document.getElementById("submit-response").addEventListener("click", function () {
        submitResponse();
    });

    document.getElementById("user-input").addEventListener("keydown", function (event) {
        if (event.key === "Enter") {
            submitResponse();
        }
    });

    function submitResponse() {
        const userInput = document.getElementById("user-input").value;

        if (userInput.trim() !== "") {
            addMessageToChat("User", userInput, "message-user");
            document.getElementById("user-input").value = ""; // Clear input field
            llmResponse(userInput); // Get response from LLM
        }
    }

    function addMessageToChat(sender, message, className) {
        const chatBox = document.getElementById("chat-box");

        const messageDiv = document.createElement("div");
        messageDiv.className = `message ${className}`;
        messageDiv.innerHTML = `<strong>${sender}:</strong> ${message}`;

        chatBox.appendChild(messageDiv);

        chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function llmResponse(userInput) {
        try {
            const response = await fetch('/generate_gemini_response', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ user_input: userInput, topic: chosenTopic })
            });

            const data = await response.json();
            const responseText = data.response;
            const llmName = (document.querySelectorAll('.message-llm').length % 2 === 0) ? "ALICE" : "BOB";
            addMessageToChat(llmName, responseText, "message-llm");
        } catch (error) {
            console.error('Error generating LLM response:', error);
            addMessageToChat("LLM", "Sorry, I couldn't generate a response.", "message-llm");
        }
    }
</script>
